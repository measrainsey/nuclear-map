dt.temp[year >= min(ret_planned[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "retired"]
dt.temp[, cum_capacity := cumsum(capacity), by = list(status)]
list_ret_planned[[i]] = dt.temp
}
rm(dt.temp,dt.un,first.temp)
list_op_current = list()
dt.un = unique(op_current[, c("plant_code")])
for (i in 1:nrow(dt.un)) {
dt.temp = op_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
list_op_current[[i]] = dt.temp
}
for (i in 1:15) {
dt.temp = op_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
list_op_current[[i]] = dt.temp
}
for (i in 1:20) {
dt.temp = op_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
list_op_current[[i]] = dt.temp
}
i=19
dt.temp = op_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
View(dt.temp)
dt.temp[, cum_capacity := cumsum(capacity)]
i=16
dt.temp = op_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
i=16
dt.temp = op_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
View(dt.temp)
i=17
dt.temp = op_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
i=18
dt.temp = op_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp = op_current[plant_code == dt.un[, plant_code][i]]
View(dt.temp)
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
View(first.temp)
View(dt_first)
View(op_planned)
View(dt_first)
dt_first = dt_first[, .SD[which.min(op_year)], by = c("plant_code")]
View(dt_first)
list_op_current = list()
dt.un = unique(op_current[, c("plant_code")])
for (i in 1:nrow(dt.un)) {
dt.temp = op_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
list_op_current[[i]] = dt.temp
}
View(dt.temp)
rm(dt.temp,dt.un,first.temp)
View(op_planned)
list_op_planned = list()
dt.un = unique(op_planned[, c("plant_code")])
View(dt.un)
View(op_planned)
View(op_planned)
View(op_planned)
op_all = rbindlist(list(op_current,op_planned))
View(op_all)
rm(list_op_current)
op_all = rbindlist(list(op_current,op_planned))
list_op_all = list()
dt.un = unique(op_all[, c("plant_code")])
i=1
dt.temp = op_all[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
str(op_all)
op_all[, year := as.numeric(year)]
list_op_all = list()
dt.un = unique(op_all[, c("plant_code")])
dt.temp = op_all[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
op_all[, capacity := as.numeric(capacity)]
op_all = rbindlist(list(op_current,op_planned))
op_all[, year := as.numeric(year)]
op_all[, capacity := as.numeric(capacity)]
list_op_all = list()
dt.un = unique(op_all[, c("plant_code")])
dt.temp = op_all[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
View(dt.temp)
View(dt.un)
View(dt_first)
i=6
dt.temp = op_all[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
View(dt.temp)
View(dt_first)
View(dt.un)
View(op_all)
View(dt.un)
i=18
dt.temp = op_all[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
View(dt.temp)
View(op_all)
View(op_planned)
colnames(op_current)
c(colnames(op_current))
setcolorder(op_planned, colnames(op_current))
colnames(op_current)
colnames(op_planned)
setnames(op_planned, "op_year", "year")
setcolorder(op_planned, colnames(op_current))
colnames(op_planned)
colnames(op_current)
op_all = rbindlist(list(op_current,op_planned))
op_all[, year := as.numeric(year)]
op_all[, capacity := as.numeric(capacity)]
list_op_all = list()
dt.un = unique(op_all[, c("plant_code")])
i=18
dt.temp = op_all[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
View(dt.temp)
colnames(dt.temp)
View(dt_first)
rm(dt.temp,dt.un,first.temp)
dt.temp = op_all[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
list_op_all = list()
dt.un = unique(op_all[, c("plant_code")])
dt.temp = op_all[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
View(dt.temp)
colnames(dt.temp)
dt.years = data.table(year = 1969:2027)
list_ret_current = list()
dt.un = unique(ret_current[, c("plant_code")])
for (i in 1:nrow(dt.un)) {
dt.temp = ret_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[year < min(ret_current[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "operating"]
dt.temp[year >= min(ret_current[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "retired"]
dt.temp[, cum_capacity := cumsum(capacity), by = list(status)]
dt.temp[, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude")]
setcolorder(dt.temp, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude"))
list_ret_current[[i]] = dt.temp
}
list_ret_current = list()
dt.un = unique(ret_current[, c("plant_code")])
for (i in 1:nrow(dt.un)) {
dt.temp = ret_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[year < min(ret_current[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "operating"]
dt.temp[year >= min(ret_current[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "retired"]
dt.temp[, cum_capacity := cumsum(capacity), by = list(status)]
dt.temp[, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude")]
setcolorder(dt.temp, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude"))
list_ret_current[[i]] = dt.temp
}
View(dt.temp)
setcolorder(dt.temp, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude"))
dt.temp[, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude")]
dt.temp = dt.temp[, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude")]
setcolorder(dt.temp, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude"))
# sequence of retired plants -----
list_ret_current = list()
dt.un = unique(ret_current[, c("plant_code")])
for (i in 1:nrow(dt.un)) {
dt.temp = ret_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[year < min(ret_current[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "operating"]
dt.temp[year >= min(ret_current[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "retired"]
dt.temp[, cum_capacity := cumsum(capacity), by = list(status)]
dt.temp = dt.temp[, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude")]
setcolorder(dt.temp, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude"))
list_ret_current[[i]] = dt.temp
}
rm(dt.temp,dt.un,first.temp)
# sequence of planned retired plants -----
list_ret_planned = list()
dt.un = unique(ret_planned[, c("plant_code")])
for (i in 1:nrow(dt.un)) {
dt.temp = ret_planned[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[year < min(ret_planned[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "operating"]
dt.temp[year >= min(ret_planned[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "retired"]
dt.temp[, cum_capacity := cumsum(capacity), by = list(status)]
dt.temp[, cum_capacity := cumsum(capacity), by = list(status)]
dt.temp = dt.temp[, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude")]
setcolorder(dt.temp, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude"))
list_ret_planned[[i]] = dt.temp
}
rm(dt.temp,dt.un,first.temp)
# sequence of current and planned operating plants -------
setcolorder(op_planned, colnames(op_current))
op_all = rbindlist(list(op_current,op_planned))
op_all[, year := as.numeric(year)]
op_all[, capacity := as.numeric(capacity)]
list_op_all = list()
dt.un = unique(op_all[, c("plant_code")])
for (i in 1:nrow(dt.un)) {
dt.temp = op_all[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
dt.temp[, cum_capacity := cumsum(capacity), by = list(status)]
dt.temp = dt.temp[, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude")]
setcolorder(dt.temp, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude"))
list_op_all[[i]] = dt.temp
}
rm(dt.temp,dt.un,first.temp)
# sequence of retired plants -----
list_ret_current = list()
dt.un = unique(ret_current[, c("plant_code")])
for (i in 1:nrow(dt.un)) {
dt.temp = ret_current[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[year < min(ret_current[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "operating"]
dt.temp[year >= min(ret_current[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "retired"]
dt.temp[, cum_capacity := cumsum(capacity), by = list(status)]
dt.temp = dt.temp[, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude")]
setcolorder(dt.temp, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude"))
list_ret_current[[i]] = dt.temp
}
rm(dt.temp,dt.un,first.temp)
# sequence of planned retired plants -----
list_ret_planned = list()
dt.un = unique(ret_planned[, c("plant_code")])
for (i in 1:nrow(dt.un)) {
dt.temp = ret_planned[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[year < min(ret_planned[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "operating"]
dt.temp[year >= min(ret_planned[plant_code == dt.un[, plant_code][i] & capacity < 0, year]), status := "retired"]
dt.temp[, cum_capacity := cumsum(capacity), by = list(status)]
dt.temp = dt.temp[, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude")]
setcolorder(dt.temp, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude"))
list_ret_planned[[i]] = dt.temp
}
rm(dt.temp,dt.un,first.temp)
# sequence of current and planned operating plants -------
setcolorder(op_planned, colnames(op_current))
op_all = rbindlist(list(op_current,op_planned))
op_all[, year := as.numeric(year)]
op_all[, capacity := as.numeric(capacity)]
list_op_all = list()
dt.un = unique(op_all[, c("plant_code")])
for (i in 1:nrow(dt.un)) {
dt.temp = op_all[plant_code == dt.un[, plant_code][i]]
first.temp = dt_first[plant_code == dt.un[, plant_code][i]]
dt.temp = dt.temp[dt.years, on = "year"]
dt.temp = dt.temp[ year >= first.temp[, op_year]]
dt.temp[, plant_code := first.temp[, plant_code]]
dt.temp[, plant_name := first.temp[, plant_name]]
dt.temp[, city := first.temp[, city]]
dt.temp[, state := first.temp[, state]]
dt.temp[, latitude := first.temp[, latitude]]
dt.temp[, longitude := first.temp[, longitude]]
dt.temp[is.na(capacity), capacity := 0]
dt.temp[, cum_capacity := cumsum(capacity)]
dt.temp = dt.temp[, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude")]
setcolorder(dt.temp, c("year", "plant_code", "plant_name", "capacity", "cum_capacity", "city", "state", "latitude", "longitude"))
list_op_all[[i]] = dt.temp
}
rm(dt.temp,dt.un,first.temp)
dt_sequence = rbindlist(list_ret_current,list_ret_planned,list_op_all)
dt_sequence = rbindlist(list(list_ret_current,list_ret_planned,list_op_all))
dt_sequence = rbindlist(c(list_ret_current,list_ret_planned,list_op_all))
View(dt_sequence)
View(ret_planned)
View(op_planned)
View(dt_sequence)
dt_sequence[, c("year", "plant_code", "plant_name", "cum_capacity", "city", "state", "latitude", "longitude")]
dt_sequence = dt_sequence[, c("year", "plant_code", "plant_name", "cum_capacity", "city", "state", "latitude", "longitude")]
View(dt_sequence)
setwd(out.dir)
fwrite(dt_first, "nuc_first.csv", row.names = FALSE)
fwrite(dt_sequence, "nuc_sequence.csv", row.names = FALSE)
View(dt_sequence)
fwrite(dt_sequence[year == 2018], "nuc_2018.csv", row.names = FALSE)
View(dt_first)
View(dt_sequence)
View(dt.years)
View(dt_sequence)
View(ret_planned)
View(dt_sequence)
years
View(dt.years)
years = 1969:2027
years
years = as.character(years)
years
