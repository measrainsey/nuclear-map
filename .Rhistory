View(ret2016)
op2016 = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, cols = c(3,7:9,16,26:29)))[ Technology == "Nuclear"][1:1010]
setwd(gen.dir)
op2016 = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, cols = c(3,7:9,16,26:29)))[ Technology == "Nuclear"][1:1010]
View(op2016)
op2016 = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, cols = c(3,7:9,16,26:29)))[ Technology == "Nuclear"]
?read.xlsx
op2016 = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:9,16,26:29)))[ Technology == "Nuclear"]
View(op2016)
ncols = colnames(op2016)[5:9]
op2016[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
prop2016 = as.data.table(read.xlsx(gen.fil, sheet = "Proposed", startRow = 2, cols = c(3,7:9,16,21:24)))[ Technology == "Nuclear"]
ret2016 = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:9,16,26:29)))[ Technology == "Nuclear"]
plant2016 = as.data.table(read.xlsx(plant.fil, startRow = 2, cols = c(3:4,6:7,10:11)))
plant2016 = plant2016[ Plant.Code %in% op2016[, Plant.Code] | Plant.Code %in% ret2016[, Plant.Code] ]
plannedret = op2016[ !is.na(Planned.Retirement.Year)]
View(plannedret)
View(plant2016)
colnames(op2016)
View(op2016)
op2016 = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
View(op2016)
ncols = colnames(op2016)[5:8]
op2016[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
prop2016 = as.data.table(read.xlsx(gen.fil, sheet = "Proposed", startRow = 2, cols = c(3,7:8,16,21:24)))[ Technology == "Nuclear"]
ret2016 = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
plant2016 = as.data.table(read.xlsx(plant.fil, startRow = 2, cols = c(3:4,6:7,10:11)))
plant2016 = plant2016[ Plant.Code %in% op2016[, Plant.Code] | Plant.Code %in% ret2016[, Plant.Code] ]
View(ret2016)
prop2016[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
ncols = colnames(op2016)[5:8]
op2016[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
prop2016[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
View(prop2016)
View(prop2016)
View(op2016)
ncols = colnames(op2016)[4:8]
op2016[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
op2016 = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(op2016)[4:8]
op2016[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
View(op2016)
gen.dir   = '/Users/MEAS/Google Drive/data/eia/860/eia8602016'
gen.fil   = '3_1_Generator_Y2016.xlsx'
plant.fil = '2___Plant_Y2016.xlsx'
add.dir   = '/Users/MEAS/Google Drive/data/eia/electric-power-monthly/february2018'
add.fil   = 'Table_6_05.xlsx'
# ------------------------------------------------------------------------------------
# load libraries ------
library(data.table)
library(lubridate)
library(openxlsx)
library(stringr)
# load current generators ------
setwd(gen.dir)
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
plan_ret = cur_op[ !is.na(Planned.Retirement.Year)]
View(plan_ret)
setwd(gen.dir)
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
plan_ret = cur_op[ !is.na(Planned.Retirement.Year)]
cur_prop = as.data.table(read.xlsx(gen.fil, sheet = "Proposed", startRow = 2, cols = c(3,7:8,16,21:24)))[ Technology == "Nuclear"]
cur_prop[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
View(cur_prop)
ncols = colnames(cur_prop)[4:8]
cur_prop[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
View(cur_prop)
gen.dir   = '/Users/MEAS/Google Drive/data/eia/860/eia8602016'
gen.fil   = '3_1_Generator_Y2016.xlsx'
plant.fil = '2___Plant_Y2016.xlsx'
add.dir   = '/Users/MEAS/Google Drive/data/eia/electric-power-monthly/february2018'
add.fil   = 'Table_6_05.xlsx'
# ------------------------------------------------------------------------------------
# load libraries ------
library(data.table)
library(lubridate)
library(openxlsx)
library(stringr)
# load current generators ------
setwd(gen.dir)
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
cur_ret = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_ret)[4:8]
cur_ret[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
View(cur_ret)
View(cur_op)
View(cur_op)
View(cur_ret)
colnames(cur_ret)
plan_ret = cur_op[ !is.na(Planned.Retirement.Year)]
setwd(gen.dir)
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_ret)[4:8]
cur_ret[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_prop = as.data.table(read.xlsx(gen.fil, sheet = "Proposed", startRow = 2, cols = c(3,7:8,16,21:24)))[ Technology == "Nuclear"]
ncols = colnames(cur_prop)[4:8]
cur_prop[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
View(cur_prop)
setwd(add.dir)
prop2018 = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1:2,6:9,11,15)))
View(prop2018)
prop2018 = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1:2,6:9,11,15)))[ Technology == "Nuclear" ]
View(prop2018)
View(cur_prop)
setwd(gen.dir)
plant2016 = as.data.table(read.xlsx(plant.fil, startRow = 2, cols = c(3:4,6:7,10:11)))
plant2016 = plant2016[ Plant.Code %in% op2016[, Plant.Code] | Plant.Code %in% ret2016[, Plant.Code] ]
plant2016 = plant2016[ Plant.Code %in% cur_op[, Plant.Code] | Plant.Code %in% cur_ret[, Plant.Code] ]
plant2016 = plant2016[ Plant.Code %in% cur_op[, plant_code] | Plant.Code %in% cur_ret[, plant_code] ]
View(plant2016)
setwd(add.dir)
cur_prop = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1:2,6:9,11,15)))[ Technology == "Nuclear" ]
View(cur_prop)
colnames(cur_prop)
cur_prop = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1:2,7:9,11,15)))[ Technology == "Nuclear" ]
colnames(cur_prop)
cur_prop = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1:2,8:9,11,15)))[ Technology == "Nuclear" ]
colnames(cur_prop)
colnames(cur_prop) = c("op_year", "op_month", "plant_code", "gen_id", "technology", "capacity")
setcolorder(cur_prop, c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year"))
cur_prop[, ret_month := NA]
cur_prop[, ret_year := NA]
setcolorder(cur_prop, c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year"))
View(cur_prop)
plant_info = plant_info[ Plant.Code %in% cur_op[, plant_code] | Plant.Code %in% cur_ret[, plant_code] | Plant.Code %in% cur_prop[, plant_code] ]
setwd(gen.dir)
plant_info = as.data.table(read.xlsx(plant.fil, startRow = 2, cols = c(3:4,6:7,10:11)))
plant_info = plant_info[ Plant.Code %in% cur_op[, plant_code] | Plant.Code %in% cur_ret[, plant_code] | Plant.Code %in% cur_prop[, plant_code] ]
View(plant_info)
str(plant_info)
str(cur_op)
cur_ret[, capacity := -capacity]
View(cur_ret)
cur_op = cur_op[!plan_ret]
View(cur_op)
View(plan_ret)
setwd(gen.dir)
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_ret)[4:8]
cur_ret[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
plan_ret = cur_op[ !is.na(ret_year)]
gen.dir   = '/Users/MEAS/Google Drive/data/eia/860/eia8602016'
gen.fil   = '3_1_Generator_Y2016.xlsx'
plant.fil = '2___Plant_Y2016.xlsx'
add.dir   = '/Users/MEAS/Google Drive/data/eia/electric-power-monthly/february2018'
add.fil   = 'Table_6_05.xlsx'
# ------------------------------------------------------------------------------------
# load libraries ------
library(data.table)
library(lubridate)
library(openxlsx)
library(stringr)
# load current generators ------
setwd(gen.dir)
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_ret)[4:8]
cur_ret[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
plan_ret = cur_op[ !is.na(ret_year)]
View(cur_op)
View(plan_ret)
cur_op = cur_op[!plan_ret]
cur_op = cur_op[!plan_ret, on = c("plant_code", "gen_id")]
View(cur_op)
cur_op = cur_op[!plan_ret, on = c("plant_code", "gen_id"), c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year")]
View(cur_op)
plan_ret = cur_op[ !is.na(ret_year), c("plant_code", "gen_id", "technology", "capacity", "ret_month", "ret_year")]
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_ret)[4:8]
cur_ret[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
plan_ret = cur_op[ !is.na(ret_year), c("plant_code", "gen_id", "technology", "capacity", "ret_month", "ret_year")]
cur_op = cur_op[!plan_ret, on = c("plant_code", "gen_id"),
c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year")]
View(cur_ret)
View(plan_ret)
View(cur_ret)
cur_ret = cur_ret[, c("plant_code", "gen_id", "technology", "capacity", "ret_month", "ret_year")]
View(cur_ret)
setwd(gen.dir)
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_ret)[4:8]
cur_ret[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = cur_ret[, c("plant_code", "gen_id", "technology", "capacity", "ret_year")]
plan_ret = cur_op[ !is.na(ret_year), c("plant_code", "gen_id", "technology", "capacity","ret_year")]
cur_op = cur_op[!plan_ret, on = c("plant_code", "gen_id"),
c("plant_code", "gen_id", "technology", "capacity", "op_year")]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "year")
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "year")
colnames(plan_ret) = c("plant_code", "gen_id", "technology", "capacity", "year")
View(cur_op)
View(cur_ret)
View(plan_ret)
View(cur_op)
cur_ret = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_ret)[4:8]
cur_ret[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = cur_ret[, c("plant_code", "gen_id", "technology", "capacity", "ret_year")]
cur_ret = [!is.na(ret_year)]
cur_ret = cur_ret[!is.na(ret_year)]
plan_ret = cur_op[ !is.na(ret_year), c("plant_code", "gen_id", "technology", "capacity","ret_year")]
cur_op = cur_op[!plan_ret, on = c("plant_code", "gen_id"),
c("plant_code", "gen_id", "technology", "capacity", "op_year")]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "year")
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "year")
colnames(plan_ret) = c("plant_code", "gen_id", "technology", "capacity", "year")
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_ret)[4:8]
cur_ret[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = cur_ret[, c("plant_code", "gen_id", "technology", "capacity", "ret_year")]
cur_ret = cur_ret[!is.na(ret_year)]
plan_ret = cur_op[ !is.na(ret_year), c("plant_code", "gen_id", "technology", "capacity","ret_year")]
cur_op = cur_op[!plan_ret, on = c("plant_code", "gen_id"),
c("plant_code", "gen_id", "technology", "capacity", "op_year")]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "year")
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "year")
colnames(plan_ret) = c("plant_code", "gen_id", "technology", "capacity", "year")
setwd(add.dir)
cur_prop = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1:2,8:9,11,15)))[ Technology == "Nuclear" ]
View(plan_ret)
plan_prop = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1:2,8:9,11,15)))[ Technology == "Nuclear" ]
View(plan_prop)
plan_prop = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1:2,8:9,11,15)))[ Technology == "Nuclear" ]
colnames(plan_prop) = c("op_year", "op_month", "plant_code", "gen_id", "technology", "capacity")
View(plan_prop)
colnames(plan_prop) = c("year", "month", "plant_code", "gen_id", "technology", "capacity")
setcolorder(plan_prop, c("plant_code", "gen_id", "technology", "capacity", "month", "year"))
View(plan_prop)
setwd(add.dir)
plan_prop = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1,8:9,11,15)))[ Technology == "Nuclear" ]
colnames(plan_prop) = c("year", "plant_code", "gen_id", "technology", "capacity")
setcolorder(plan_prop, c("plant_code", "gen_id", "technology", "capacity", "year"))
View(plan_prop)
View(cur_ret)
setwd(gen.dir)
plant_info = as.data.table(read.xlsx(plant.fil, startRow = 2, cols = c(3:4,6:7,10:11)))
View(plant_info)
colnames(plant_info)
colnames(plant_info) = c("plant_code", "plant_name", "city", "state", "latitude", "longitude")
plant_info = plant_info[ plant_code %in% cur_op[, plant_code] |
plant_code %in% cur_ret[, plant_code] |
plant_code %in% cur_prop[, plant_code] ]
colnames(plant_info) = c("plant_code", "plant_name", "city", "state", "latitude", "longitude")
plant_info = plant_info[ plant_code %in% cur_op[, plant_code] |
plant_code %in% cur_ret[, plant_code] |
plant_code %in% cur_prop[, plant_code] ]
plant_info = plant_info[ plant_code %in% cur_op[, plant_code] |
plant_code %in% cur_ret[, plant_code] |
plant_code %in% plan_prop[, plant_code] ]
View(plant_info)
cur_ret[, capacity := -capacity]
View(cur_ret)
plan_ret[, capacity := -capacity]
View(plan_ret)
gen.dir   = '/Users/MEAS/Google Drive/data/eia/860/eia8602016'
gen.fil   = '3_1_Generator_Y2016.xlsx'
plant.fil = '2___Plant_Y2016.xlsx'
add.dir   = '/Users/MEAS/Google Drive/data/eia/electric-power-monthly/february2018'
add.fil   = 'Table_6_05.xlsx'
# ------------------------------------------------------------------------------------
# load libraries ------
library(data.table)
library(lubridate)
library(openxlsx)
library(stringr)
# load current generators ------
setwd(gen.dir)
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_ret)[4:8]
cur_ret[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = cur_ret[, c("plant_code", "gen_id", "technology", "capacity", "ret_year")]
cur_ret = cur_ret[!is.na(ret_year)]
plan_ret = cur_op[ !is.na(ret_year), c("plant_code", "gen_id", "technology", "capacity","ret_year")]
cur_op = cur_op[!plan_ret, on = c("plant_code", "gen_id"),
c("plant_code", "gen_id", "technology", "capacity", "op_year")]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "year")
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "year")
colnames(plan_ret) = c("plant_code", "gen_id", "technology", "capacity", "year")
# cur_prop = as.data.table(read.xlsx(gen.fil, sheet = "Proposed", startRow = 2, cols = c(3,7:8,16,21:24)))[ Technology == "Nuclear"]
#
#   ncols = colnames(cur_prop)[4:8]
#   cur_prop[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
setwd(add.dir)
plan_prop = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1,8:9,11,15)))[ Technology == "Nuclear" ]
colnames(plan_prop) = c("year", "plant_code", "gen_id", "technology", "capacity")
setcolorder(plan_prop, c("plant_code", "gen_id", "technology", "capacity", "year"))
setwd(gen.dir)
plant_info = as.data.table(read.xlsx(plant.fil, startRow = 2, cols = c(3:4,6:7,10:11)))
colnames(plant_info) = c("plant_code", "plant_name", "city", "state", "latitude", "longitude")
plant_info = plant_info[ plant_code %in% cur_op[, plant_code] |
plant_code %in% cur_ret[, plant_code] |
plant_code %in% plan_prop[, plant_code] ]
# set retirements as negative ------
cur_ret[, capacity := -capacity]
plan_ret[, capacity := -capacity]
# all generators together -----
dt_all = rbindlist(list(cur_op, cur_ret, plan_ret, plan_prop))
View(dt_all)
gen.dir   = '/Users/MEAS/Google Drive/data/eia/860/eia8602016'
gen.fil   = '3_1_Generator_Y2016.xlsx'
plant.fil = '2___Plant_Y2016.xlsx'
add.dir   = '/Users/MEAS/Google Drive/data/eia/electric-power-monthly/february2018'
add.fil   = 'Table_6_05.xlsx'
# ------------------------------------------------------------------------------------
# load libraries ------
library(data.table)
library(lubridate)
library(openxlsx)
library(stringr)
# load current generators ------
setwd(gen.dir)
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_ret)[4:8]
cur_ret[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = cur_ret[, c("plant_code", "gen_id", "technology", "capacity", "ret_year")]
cur_ret = cur_ret[!is.na(ret_year)]
plan_ret = cur_op[ !is.na(ret_year), c("plant_code", "technology", "capacity","ret_year")]
cur_op = cur_op[!plan_ret, on = c("plant_code", "gen_id"),
c("plant_code", "technology", "capacity", "op_year")]
colnames(cur_op) = c("plant_code", "technology", "capacity", "year")
colnames(cur_ret) = c("plant_code", "technology", "capacity", "year")
colnames(plan_ret) = c("plant_code", "technology", "capacity", "year")
plan_ret = cur_op[ !is.na(ret_year), c("plant_code", "gen_id", "technology", "capacity","ret_year")]
cur_op = cur_op[!plan_ret, on = c("plant_code", "gen_id"),
c("plant_code", "technology", "capacity", "op_year")]
colnames(cur_op) = c("plant_code", "technology", "capacity", "year")
colnames(cur_ret) = c("plant_code", "technology", "capacity", "year")
plan_ret = cur_op[ !is.na(ret_year), c("plant_code", "technology", "capacity","ret_year")]
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_ret)[4:8]
cur_ret[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = cur_ret[, c("plant_code", "gen_id", "technology", "capacity", "ret_year")]
cur_ret = cur_ret[!is.na(ret_year)]
View(plan_ret)
View(cur_ret)
View(cur_op)
plan_ret = cur_op[ !is.na(ret_year), c("plant_code", "technology", "capacity","ret_year")]
plan_ret = cur_op[ !is.na(ret_year), c("plant_code", "gen_id", "technology", "capacity","ret_year")]
cur_op = cur_op[!plan_ret, on = c("plant_code", "gen_id"),
c("plant_code", "technology", "capacity", "op_year")]
plan_ret = plan_ret[, c("plant_code", "gen_id", "technology", "capacity","ret_year")]
colnames(cur_op) = c("plant_code", "technology", "capacity", "year")
colnames(cur_ret) = c("plant_code", "technology", "capacity", "year")
cur_ret = cur_ret[, c("plant_code", "technology", "capacity", "ret_year")]
plan_ret = plan_ret[, c("plant_code", "technology", "capacity","ret_year")]
colnames(cur_op) = c("plant_code", "technology", "capacity", "year")
colnames(cur_ret) = c("plant_code", "technology", "capacity", "year")
colnames(plan_ret) = c("plant_code", "technology", "capacity", "year")
setwd(add.dir)
plan_prop = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1,8:9,11,15)))[ Technology == "Nuclear" ]
colnames(plan_prop) = c("year", "plant_code", "gen_id", "technology", "capacity")
setcolorder(plan_prop, c("plant_code", "technology", "capacity", "year"))
plan_prop = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1,8,11,15)))[ Technology == "Nuclear" ]
colnames(plan_prop) = c("year", "plant_code", "gen_id", "technology", "capacity")
colnames(plan_prop) = c("year", "plant_code", "technology", "capacity")
setcolorder(plan_prop, c("plant_code", "technology", "capacity", "year"))
setwd(gen.dir)
plant_info = as.data.table(read.xlsx(plant.fil, startRow = 2, cols = c(3:4,6:7,10:11)))
colnames(plant_info) = c("plant_code", "plant_name", "city", "state", "latitude", "longitude")
plant_info = plant_info[ plant_code %in% cur_op[, plant_code] |
plant_code %in% cur_ret[, plant_code] |
plant_code %in% plan_prop[, plant_code] ]
View(plant_info)
cur_ret[, capacity := -capacity]
plan_ret[, capacity := -capacity]
dt_all = rbindlist(list(cur_op, cur_ret, plan_ret, plan_prop))
View(dt_all)
dt_op = dt_op[, lapply(.SD, sum), by = c("plant_code")]
dt_all = dt_all[, lapply(.SD, sum), by = c("plant_code")]
dt_all[, (2:4) := lapply(.SD, as.numeric), .SDcols = 2:4 ]
View(dt_all)
gen.dir   = '/Users/MEAS/Google Drive/data/eia/860/eia8602016'
gen.fil   = '3_1_Generator_Y2016.xlsx'
plant.fil = '2___Plant_Y2016.xlsx'
add.dir   = '/Users/MEAS/Google Drive/data/eia/electric-power-monthly/february2018'
add.fil   = 'Table_6_05.xlsx'
# ------------------------------------------------------------------------------------
# load libraries ------
library(data.table)
library(lubridate)
library(openxlsx)
library(stringr)
# load current generators ------
setwd(gen.dir)
cur_op = as.data.table(read.xlsx(gen.fil, sheet = "Operable", startRow = 2, rows = 2:20726,
cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_op)[4:8]
cur_op[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_op) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = as.data.table(read.xlsx(gen.fil, sheet = "Retired and Canceled",
startRow = 2, cols = c(3,7:8,16,26:29)))[ Technology == "Nuclear"]
ncols = colnames(cur_ret)[4:8]
cur_ret[, (ncols) := lapply(.SD, as.numeric), .SDcols = ncols ]
colnames(cur_ret) = c("plant_code", "gen_id", "technology", "capacity", "op_month", "op_year", "ret_month", "ret_year")
cur_ret = cur_ret[, c("plant_code", "capacity", "ret_year")]
cur_ret = cur_ret[!is.na(ret_year)]
plan_ret = cur_op[ !is.na(ret_year), c("plant_code", "gen_id", "technology", "capacity","ret_year")]
cur_op = cur_op[!plan_ret, on = c("plant_code", "gen_id"),
c("plant_code", "capacity", "op_year")]
plan_ret = plan_ret[, c("plant_code", "capacity","ret_year")]
colnames(cur_op) = c("plant_code", "capacity", "year")
colnames(cur_ret) = c("plant_code", "capacity", "year")
colnames(plan_ret) = c("plant_code", "capacity", "year")
setwd(add.dir)
plan_prop = as.data.table(read.xlsx(add.fil, startRow = 2, cols = c(1,8,11,15)))[ Technology == "Nuclear" ]
View(plan_prop)
colnames(plan_prop) = c("year", "plant_code", "technology", "capacity")
plan_prop = plan_prop[, c("year", "plant_code", "capacity")]
setcolorder(plan_prop, c("plant_code", "capacity", "year"))
setwd(gen.dir)
plant_info = as.data.table(read.xlsx(plant.fil, startRow = 2, cols = c(3:4,6:7,10:11)))
colnames(plant_info) = c("plant_code", "plant_name", "city", "state", "latitude", "longitude")
plant_info = plant_info[ plant_code %in% cur_op[, plant_code] |
plant_code %in% cur_ret[, plant_code] |
plant_code %in% plan_prop[, plant_code] ]
cur_ret[, capacity := -capacity]
plan_ret[, capacity := -capacity]
dt_all[, (2:3) := lapply(.SD, as.numeric), .SDcols = 2:3 ]
dt_all = rbindlist(list(cur_op, cur_ret, plan_ret, plan_prop))
dt_all[, (2:3) := lapply(.SD, as.numeric), .SDcols = 2:3 ]
dt_all = dt_all[, lapply(.SD, sum), by = c("plant_code")]
View(dt_all)
dt_all = rbindlist(list(cur_op, cur_ret, plan_ret, plan_prop))
dt_all[, (2:3) := lapply(.SD, as.numeric), .SDcols = 2:3 ]
dt_all = dt_all[, lapply(.SD, sum), by = c("plant_code", "year")]
View(dt_all)
dt_all[dt_all, on = "plant_code"]
dt_all = dt_all[plant_info, on = "plant_code"]
View(dt_all)
dt_1986 = dt_all[ year == "1986"]
out.dir   = '/Users/MEAS/GitHub/nuclear-map'
setwd(out.dir)
fwrite(dt_all, "dt_all.csv", row.names = FALSE)
fwrite(dt_1986, "dt_1986.csv", row.names = FALSE)
