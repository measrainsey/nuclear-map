<!DOCTYPE html>
<meta charset="utf-8">
<style>

body {
   /* font-family: 'Roboto Condensed', sans-serif; */
    font: 14px/16px "Helvetica Neue", Helvetica, Arial, sans-serif;
}

h1 {
	font: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 35px;
}



.states {
  fill: #ccc;
  stroke: #fff;
}

.symbol{
    fill: #67a9cf;
    stroke: #67a9cf;
    opacity: 0.65;
}

.symbol:hover {
    fill-opacity: 1;
    stroke-width: 1px;
}

.symbol--gain{
  fill: #67a9cf;
  stroke: #67a9cf;
  fill-opacity: .65;
  stroke-opacity: 1;
}
.symbol--loss{
    fill: #ef8a62;
    stroke: #ef8a62;
    fill-opacity: .65;
    stroke-opacity: 1;
}

div.tooltip {
 	position: absolute;
    background-color: white;
	text-align: center;
	padding: 10px;
	font-size: 12px;
	border: 1px solid #ccc;
	border-radius: 5px;
	pointer-events: none;
    -webkit-box-shadow: 0px 0px 5px 0px rgba(0,0,0,0.25);
    -moz-box-shadow: 0px 0px 5px 0px rgba(0,0,0,0.25);
    box-shadow: 0px 0px 5px 0px rgba(0,0,0,0.25);
}


#slider {
  position: absolute;
  left: 50%;
  margin-left: -300px;
  bottom: 20px;
  width: 600px;
  height: 50px;
}



</style>
<head>
    <link rel="stylesheet" href="css/main.css" />
    <title>Nuclear Power in the U.S.</title>
</head>
<body>
<!-- <h1>U.S. Nuclear Generation in <span id="year">1968</span></h1> -->
<script src="//d3js.org/d3.v3.min.js"></script>
<script src="//d3js.org/topojson.v1.min.js"></script>
<script src="//d3js.org/queue.v1.min.js"></script>
<link href="https://fonts.googleapis.com/css?family=Roboto+Condensed" rel="stylesheet">
<script src="static/chroniton.js"></script>
<link href="static/chroniton.css" rel="stylesheet">
<div id="slider"></div>

<script>

var plants = {},
	startYear = 1968,
	endYear = 2027,
  currentYear = startYear;

var width = 960,
    height = 550;

var projection = d3.geo.albersUsa();

var svg = d3.select("body")
    .append("svg")
    .attr("width", width)
    .attr("height", height);

var radius = d3.scale.sqrt()
    .domain([0, 1e6])
    .range([0, 10]);

var path = d3.geo.path();

var div = d3.select("body")
		    .append("div")
    		.attr("class", "tooltip")
    		.style("opacity", 0);

queue()
    .defer(d3.json, "us.json")
    .defer(d3.csv, "nuc_sequence_4.csv")
    .defer(d3.csv, "nuc_first.csv")
    .await(ready);

function ready(error, us, sequence, first) {
  if (error) throw error;

  svg.append("path")
      .attr("class", "states")
      .datum(topojson.feature(us, us.objects.states))
      .attr("d", path);


		// function update() {
		//
		// 	plants = svg.selectAll(".symbol")
		// 			.data(sequence.filter(function(d) { return d.year == currentYear; })
		// 						.sort(function(a, b) { return b.cum_capacity - a.cum_capacity; }))
		//
		// 	plants.exit()
		// 	.remove();
		//
		//
		// 	plants.enter()
		// 			.append("circle")
		// 			.attr("cx", function(d) {
		// 				return projection([d.longitude, d.latitude])[0];})
		// 			.attr("cy", function(d) {
		// 				return projection([d.longitude, d.latitude])[1];})
		// 			.attr("class", function(d) { return "symbol symbol--" + (d.cum_capacity < 0 ? "loss" : "gain"); })
		// 			.attr("r", function(d) { return Math.abs(d.cum_capacity)/70;} )
		//       .attr("vector-effect","non-scaling-stroke")
		//       .on("mouseover", function(d) {
		//         div.transition()
		//             .style("left", (d3.event.pageX + 10) + "px")
		//             .style("top", (d3.event.pageY - 80) + "px")
		//             .duration(200)
		//             .style("opacity", .9);
		//         div.html("<strong>" + d.plant_name + "</strong><br/>" +
		// 				(d.cum_capacity < 0 ? Math.abs(d.cum_capacity) + " MW removed" + "<br/>" + Math.abs( d.net_capacity ) + " MW remaining"  : Math.abs( d.cum_capacity ) + " MW total") +
		// 				"<br/>" + d.city + ", " + d.state)
		// 	   			})
		//       .on("mouseout", function(d) {
		//         div.transition()
		//            .duration(500)
		//            .style("opacity", 0);
		//         	})
		// 			;
		//
		// 		plants.transition().duration(500)
		// 			.ease("linear")
		//
		//
		//
		// 				d3.select("#year").html(currentYear);
		//
		// }
		//
		// update();
		//
		// d3.select("#slider")
		// 		.call(
		// 			chroniton()
		// 				.domain([new Date(startYear, 1, 1), new Date(endYear, 1, 1)])
		// 				.labelFormat(function(date) {
		// 					return Math.ceil((date.getFullYear()) / 1) * 1;
		// 				})
		// 				.width(600)
		// 				.on('change', function(date) {
		// 					var newYear = Math.ceil((date.getFullYear()) / 1) * 1;
		// 					if (newYear != currentYear) {
		// 							currentYear = newYear;
		// 							svg.selectAll("circle")
		// 								.remove();
		// 							update();
		// 					}
		// 				})
		// 				.playButton(true)
		// 				.playbackRate(0.2)
		// 				.loop(true)
		// 		);

			}

</script>
